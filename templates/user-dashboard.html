<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>FiestaPivot</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" type="text/css" media="screen" href="static/CSS/userDash.css" />

        <!-- W3 schools modal stylsheet  -->
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

        <!--Bootstrap CDN and JS-->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    </head>
    <body>
        
        <!-- Need to change buttons in nav bar to correctly pop up modals -->
        
        <!--Navbar (Bootstrap taken from https://www.codeply.com/go/qhaBrcWp3v) -->
        <nav class="navbar navbar-expand-md navbar-dark bg-primary">
            <a class="navbar-brand abs" href="/">FiestaPivot</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsingNavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="navbar-collapse collapse" id="collapsingNavbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/search">Search</a>
                    </li>
                </ul>
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a href="/post-ad">
                            <button type="button" class="btn btn-light">Post an Ad</button>
                        </a>
                    </li>
                    <li style="margin-left: 10px;" class="nav-item">
                        <a href="/logout">
                            <button type="button" class="btn btn-light">Sign Out</button>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <div class="jumbotron jumbotron-fluid">
          <div class="container">
            <h1 class="display-5">Welcome back {{name[0]}}</h1>
            <hr>
            <h1 class="display-5">My Dashboard</h1>
            <hr class="my-4">
            <div id="active">
                <p class="lead">My ads</p>
                {% for ad in ads %}
                <a onclick="show_modal('ad-{{ad[0]}}')" class="list-group-item list-group-item-action flex-column align-items-start" style="width: 100%;">
                    <div class="d-flex w-100 justify-content-between">
                        <h5 class="mb-1">{{ ad[2] }}</h5>
                        <small>Start date: {{ ad[8] }}</small>
                    </div>
                    <p class="mb-1">{{ ad[6] }}</p>
                    <small>Price: {{ ad[3] }}</small>
                    <small>Alcohol provisions: {{ ad[11] }}</small>
                    <small>Number of people: {{ ad[12] }}</small>
                    <small>Status: {{ ad[7] }}</small>
                </a>

                <!--Modals for each ad-->
                <!--AD MODALS-->
                <div class="Modals">
                    <div id="ad-{{ad[0]}}" class="w3-modal">
                        <div class="w3-modal-content w3-card-4 w3-animate-zoom" style="max-width:600px">
                        <div class="w3-center"><br>
                            <span onclick="document.getElementById('ad-{{ad[0]}}').style.display='none'" class="w3-button w3-xlarge w3-hover-red w3-display-topright" title="Close Modal">&times;</span>
                            <p id="adTitle">{{ad[0]}}. {{ad[2]}}</p>
                        </div>
                        
                        <!--Put bids for ad in here-->
                        {% for bid in bidsOrdered %}
                            {% if bid[1] == ad[0] %}
                            <a onclick="" class="list-group-item list-group-item-action flex-column align-items-start" style="width: 100%;">
                                <div class="d-flex w-100 justify-content-between">
                                    <h5 class="mb-1" id="name" >Ad name: {{ bid[2] }}</h5>
                                </div>
                                <p class="mb-1" id="comment">Special request: {{ bid[5] }}</p>
                                <small id="price">Bid: {{ bid[4] }}</small>
                                <small id="User">Posted by user: {{ bid[3] }}</small>
                            </a>
                            {% endif %}
                        {% endfor %}

                        <div class="w3-container w3-center w3-border-top w3-padding-16 w3-light-grey">
                            <div style="display: inline;" >
                                <button type="button" class="w3-button w3-green">Edit</button>
                            </div>
                            <form style="display: inline;" action="/delete-ad" method="POST">
                                <input style="display: none" name="id" type="text" value="{{ad[0]}}">
                                <button type="submit" class="w3-button w3-red">Delete</button>
                            </form>
                        </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <br>
            <div id="active">
                <p class="lead">My Bids</p>
                {% for bid in bids %}
                <a onclick="show_modal('bid-{{bid[0]}}')" class="list-group-item list-group-item-action flex-column align-items-start" style="width: 100%;">
                    <div class="d-flex w-100 justify-content-between">
                        <h5 class="mb-1" id="name" >Ad name: {{ bid[2] }}</h5>
                    </div>
                    <p class="mb-1" id="comment">Special request: {{ bid[5] }}</p>
                    <small id="price">Bid: {{ bid[4] }}</small>
                    <small id="User">Posted by user: {{ bid[3] }}</small>
                    <small id="status">Status: {{ bid[6] }}</small>
                </a>

                <!--Modals for each bid-->
                <!--bid MODALS-->
                <div class="Modals">
                    <div id="bid-{{bid[0]}}" class="w3-modal">
                        <div class="w3-modal-content w3-card-4 w3-animate-zoom" style="max-width:600px">
                        <div class="w3-center"><br>
                            <span onclick="document.getElementById('bid-{{bid[0]}}').style.display='none'" class="w3-button w3-xlarge w3-hover-red w3-display-topright" title="Close Modal">&times;</span>
                            <p id="adTitle">{{bid[0]}}. {{bid[2]}}</p>
                        </div>
                        <div class="w3-container w3-center w3-border-top w3-padding-16 w3-light-grey">
                            <div style="display: inline;" >
                                <button type="button" class="w3-button w3-green">Edit</button>
                            </div>
                            <form style="display: inline;" action="/delete-bid" method="POST">
                                <input style="display: none" name="id" type="text" value="{{bid[0]}}">
                                <button type="submit" class="w3-button w3-red">Delete</button>
                            </form>
                        </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <br>
            <div id="active">
                <p class="lead">My Info</p>
                
            </div>

          </div>
        </div>

        <!-- Modal for showing bids associated with ad NEED TO CHANGE
        <div class="Modals">
            <div id="bid" class="w3-modal">
                <div class="w3-modal-content w3-card-4 w3-animate-zoom" style="max-width:600px">
                    
                    <div class="w3-center"><br>
                        <span onclick="document.getElementById('bid').style.display='none'" class="w3-button w3-xlarge w3-hover-red w3-display-topright" title="Close Modal">&times;</span>
                        <label id="bidTitle"></label>
                    </div>
                    
                    <form action="/bid-send" method="post" class="w3-container w3-center w3-border-top w3-padding-16 w3-light-grey">
                        <div class="w3-container">
                            <div class="w3-section">
                                <h3>Your price:</h3>
                                    <input id="priceInput" name="priceInput">
                                <h3>Additional messages/comments to poster:</h3>
                                    <input id="commentInput" name="commentInput" placeholder="Please provide salt, cleanup incuded etc.">
                                <input id="adID" name="adID" type="hidden">
                            </div>
                        </div>
                        <button type="submit" value="Place Bid" type="button" class="w3-button w3-red">Place bid</button>
                    </form>
                </div>
            </div>
        </div> -->

        

    <!-- Footer -->
    <footer class="page-footer font-small navbar-dark bg-dark pt-4">
        <div class="container text-center">
            <p class="text-light">
            FiestaPivot is an innovative new take on the outsourcing business model - bringing all its benefits to the realm of food preparation. Find people to cater for your party, black tie function, or picnic, or offer your services to help new clients, and become the most in-demand business in town.
            </p>
        </div>
        <div class="text-center py-3"><p class="text-light">© 2018 Copyright Team Artemis</div>
    </footer>

    <script>
        function show_modal(id) {
            document.getElementById(id).style.display='block'
        }
    </script>
    </body>
</html> 